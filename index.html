<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Jobs | Home</title>
    <link rel="icon" href="./assets/favicon-32x32.png">
    <link rel="stylesheet" href="./style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp"
      rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9352316807433103"
     crossorigin="anonymous"></script>
</head>
<body>
    <section>
        <header></header>
        <div class="head-contain flex-col space-btw">
            <div class="title-n-contrast flex-row space-btw">
                <a href="./index.html">
                <svg class="logo-icon" width="115" height="32" xmlns="http://www.w3.org/2000/svg"><path d="M7.612 24.08c1.022 0 1.967-.178 2.838-.531a6.998 6.998 0 002.29-1.498l.109 1.711h4.252V0h-4.502v9.49a7.369 7.369 0 00-2.251-1.387 7.394 7.394 0 00-2.736-.499c-1.458 0-2.764.356-3.915 1.07-1.152.712-2.056 1.689-2.712 2.93C.328 12.844 0 14.257 0 15.842c0 1.584.328 2.996.985 4.237.656 1.241 1.56 2.218 2.712 2.93 1.151.714 2.457 1.07 3.915 1.07zm1.017-3.961c-1.147 0-2.095-.407-2.845-1.22s-1.126-1.832-1.126-3.057c0-1.225.375-2.245 1.126-3.058.75-.813 1.698-1.22 2.845-1.22 1.146 0 2.094.407 2.844 1.22s1.126 1.833 1.126 3.058c0 1.225-.375 2.244-1.126 3.057-.75.813-1.698 1.22-2.844 1.22zm20.258 3.96c1.084 0 2.217-.18 3.4-.538 1.182-.36 2.378-1.02 3.587-1.98l-2.72-3.296a7.804 7.804 0 01-1.946 1.37c-.714.354-1.613.531-2.696.531-1.011 0-1.894-.274-2.65-.823a4.154 4.154 0 01-1.555-2.139h12.192v-1.378c0-1.595-.354-3.01-1.063-4.246a7.772 7.772 0 00-2.9-2.915c-1.224-.707-2.623-1.061-4.196-1.061-1.584 0-2.999.356-4.244 1.07a7.897 7.897 0 00-2.947 2.914c-.719 1.23-1.078 2.632-1.078 4.206 0 1.595.375 3.018 1.125 4.27.75 1.25 1.787 2.233 3.11 2.946 1.324.713 2.85 1.07 4.58 1.07zm2.985-9.41h-7.659a4.047 4.047 0 011.383-2.233c.704-.581 1.535-.872 2.494-.872.948 0 1.76.286 2.438.856.677.57 1.126 1.32 1.344 2.25zm16.273 9.093l6.174-15.841h-4.736l-2.61 7.715a23.244 23.244 0 00-.509 1.774c-.193.76-.351 1.452-.477 2.075h-.062a32.377 32.377 0 00-.43-2.09c-.182-.772-.346-1.358-.492-1.76l-2.83-7.714h-4.892l6.487 15.841h4.377zM58.399 5.07c.75 0 1.355-.232 1.813-.697.459-.464.688-1.077.688-1.837s-.23-1.373-.688-1.838C59.754.232 59.149 0 58.399 0s-1.355.232-1.813.697c-.459.465-.688 1.077-.688 1.838 0 .76.229 1.373.688 1.837.458.465 1.062.697 1.813.697zM54.882 32c1.865 0 3.293-.504 4.283-1.513.99-1.008 1.485-2.453 1.485-4.333V7.921h-4.502v17.71c0 .75-.237 1.34-.711 1.767-.474.428-1.076.642-1.806.642-.542 0-1.1-.122-1.672-.365v3.739c.99.39 1.964.586 2.923.586zm16.835-7.92c1.605 0 3.032-.357 4.283-1.07a7.903 7.903 0 002.962-2.93c.724-1.242 1.086-2.654 1.086-4.238 0-1.585-.362-2.997-1.086-4.238A7.903 7.903 0 0076 8.674c-1.25-.714-2.678-1.07-4.283-1.07-1.605 0-3.035.356-4.291 1.07a7.887 7.887 0 00-2.97 2.93c-.724 1.24-1.086 2.653-1.086 4.238 0 1.584.362 2.996 1.086 4.237a7.887 7.887 0 002.97 2.93c1.256.714 2.686 1.07 4.29 1.07zm0-3.961c-1.147 0-2.095-.407-2.845-1.22s-1.126-1.832-1.126-3.057c0-1.225.376-2.245 1.126-3.058.75-.813 1.698-1.22 2.845-1.22 1.146 0 2.094.407 2.845 1.22.75.813 1.125 1.833 1.125 3.058 0 1.225-.375 2.244-1.125 3.057-.75.813-1.699 1.22-2.845 1.22zm20.79 3.96c1.469 0 2.777-.356 3.923-1.07 1.146-.712 2.048-1.689 2.704-2.93.657-1.24.985-2.653.985-4.237 0-1.585-.328-2.997-.985-4.238-.656-1.241-1.558-2.218-2.704-2.93-1.146-.714-2.454-1.07-3.924-1.07-.98 0-1.89.166-2.735.499a7.369 7.369 0 00-2.251 1.386V0h-4.502v23.762h4.252l.11-1.71a6.978 6.978 0 002.297 1.497c.876.353 1.819.53 2.83.53zm-1.017-3.96c-1.146 0-2.094-.407-2.844-1.22s-1.126-1.832-1.126-3.057c0-1.225.375-2.245 1.126-3.058.75-.813 1.698-1.22 2.844-1.22 1.147 0 2.095.407 2.845 1.22s1.126 1.833 1.126 3.058c0 1.225-.375 2.244-1.126 3.057-.75.813-1.698 1.22-2.845 1.22zm17.304 3.96c1.136 0 2.173-.198 3.111-.594.938-.396 1.688-.969 2.25-1.719.564-.75.845-1.642.845-2.677 0-1.035-.263-1.872-.79-2.51a5.958 5.958 0 00-1.93-1.537c-.76-.386-1.5-.721-2.22-1.006a18.284 18.284 0 01-1.727-.777c-.484-.253-.727-.575-.727-.966 0-.348.175-.583.524-.705.35-.121.67-.182.961-.182.511 0 1.134.119 1.868.356.735.238 1.332.51 1.79.816l1.985-3.47a9.31 9.31 0 00-2.837-1.148 13.27 13.27 0 00-2.962-.356c-1.917 0-3.4.433-4.447 1.299-1.047.866-1.571 1.97-1.571 3.31 0 .972.247 1.765.742 2.377a5.807 5.807 0 001.845 1.497 28.35 28.35 0 002.196 1.038c.688.285 1.295.575 1.821.871.526.296.79.681.79 1.156 0 .328-.141.597-.422.808-.282.212-.652.317-1.11.317-.594 0-1.269-.177-2.025-.53-.755-.354-1.58-.832-2.477-1.434l-2.126 3.437c1.053.793 2.155 1.379 3.306 1.759 1.152.38 2.264.57 3.337.57z" fill="#FFF" fill-rule="nonzero"/></svg>
                </a>

                <div id="theme-toggle" class="theme-toggler">
                    <span class="material-icons-sharp active">light_mode</span>
                    <span class="material-icons-sharp">dark_mode</span>
                </div>
            </div>
                <form id="form" class="header-form flex-row all-center">
                    <div class="by-tit flex-row ">
                        <svg class="mob-hide mg-r-16" width="24" height="24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M17.112 15.059h-1.088l-.377-.377a8.814 8.814 0 002.15-5.784A8.898 8.898 0 008.898 0 8.898 8.898 0 000 8.898a8.898 8.898 0 008.898 8.899c2.211 0 4.23-.808 5.784-2.143l.377.377v1.081l6.845 6.832 2.04-2.04-6.832-6.845zm-8.214 0A6.16 6.16 0 118.9 2.737a6.16 6.16 0 010 12.322z"
                                fill="#5964E0" fill-rule="nonzero" />
                        </svg>
                
                        <input id="filter1" class="w-300" type="text" name="filter1" placeholder="Filter by title, company, expertise...">
                    </div>
                
                    <div class="mob-hide by-loc flex-row ">
                        <svg class="mg-r-16" width="17" height="24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M14.358 2.451A8.3 8.3 0 008.448 0a8.3 8.3 0 00-5.911 2.451c-2.922 2.925-3.285 8.427-.786 11.76l6.697 9.683 6.687-9.669c2.508-3.347 2.145-8.85-.777-11.774zm-5.833 8.894a3.057 3.057 0 01-3.051-3.054 3.057 3.057 0 013.05-3.055 3.057 3.057 0 013.052 3.055 3.057 3.057 0 01-3.051 3.054z"
                                fill="#5964E0" fill-rule="nonzero" />
                        </svg>
                
                        <input id="filter2" type="text" name="filter2" placeholder="Filter by location...">
                    </div>
                
                    <div class="flex-row by-check space-btw">
                        <label class="mob-hide" for="">
                            <input class="mg-r-16" type="checkbox" name="filter3" id="filter3">
                            Full Time
                        </label>
                        <svg class="mob-show" width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M19.108 0H.86a.86.86 0 00-.764.455.833.833 0 00.068.884l6.685 9.202.007.01c.242.32.374.708.375 1.107v7.502a.825.825 0 00.248.594.865.865 0 00.942.18l3.756-1.4c.337-.1.56-.41.56-.784v-6.092c0-.399.132-.787.375-1.108l.007-.009 6.685-9.202c.19-.26.217-.6.068-.884A.86.86 0 0019.108 0z" fill="var(--color-filter)" fill-rule="nonzero"/></svg>
                        <button id="search" type="submit">
                            <svg class="mob-show" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.112 15.059h-1.088l-.377-.377a8.814 8.814 0 002.15-5.784A8.898 8.898 0 008.898 0 8.898 8.898 0 000 8.898a8.898 8.898 0 008.898 8.899c2.211 0 4.23-.808 5.784-2.143l.377.377v1.081l6.845 6.832 2.04-2.04-6.832-6.845zm-8.214 0A6.16 6.16 0 118.9 2.737a6.16 6.16 0 010 12.322z" fill="#ffffff" fill-rule="nonzero"/></svg>
                            <span class="mob-hide" style="color:#ffffff;">Search</span></button>
                    </div>
                </form>
        </div>
    </section>
    <main class="flex-col">
        <section id="container">
            <!-- <a id="covering-card" class="covering-card">
                <div id="joblogo" class="logo"></div>
                <div class="card">
                    <div class="time-and-type">
                        <span id="jobPostTime">5h ago</span>
                        <svg width="4" height="4" viewBox="0 0 4 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="2" cy="2" r="2" fill="#6E8098"/>
                            </svg>                        
                        <span id="jobType" >Full Time</span>
                    </div>
                    <h3 id="jobTitle" >Senior Software Engineer</h3>
                    <span id="jobCompany" >Scoot</span>
                    <p class="small" id="jobLocation">United States</p>
                </div>
            </a>       -->
        </section>
        <button id="load-more">Load More</button>
    </main>
    <script>
        const themeToggler = document.getElementById('theme-toggle');
        const container = document.getElementById('container');
        
        const fileOnSystem = "./data.json";
        const loadMore = document.getElementById('load-more');
        (async () => {
            try {
                let content = (response, i) => { return `
                        <a onclick='sendLocal(${JSON.stringify(response[i])})' id="covering-card" class="covering-card">
                            <div id="joblogo" class="logo flex all-center" style="background-color:${response[i].logoBackground}">
                                <img src="${response[i].logo}">
                            </div>
                            <div class="card space-btw flex-col">
                                <div class="post-det space-btw flex-col">
                                    <div class="time-and-type">
                                        <span id="jobPostTime">${response[i].postedAt}</span>
                                        <svg class="mg-lr-small" width="4" height="4" viewBox="0 0 4 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <circle cx="2" cy="2" r="2" fill="#6E8098" />
                                        </svg>
                                        <span id="jobType" >${response[i].contract}</span>
                                    </div>
                                    <h3 id="jobTitle" >${response[i].position}</h3>
                                    <span id="jobCompany">${response[i].company}</span>
                                </div>
                                <p class="small" id="jobLocation">${response[i].location}</p>
                            </div>
                        </a>
                    `};
                const data = await fetch(fileOnSystem);
                const unfiltered = await data.json();
                
                //filtering function
                const form = document.getElementById('form');
                let filters;
                const setValues = (val1, val2, val3) => {
                    return {
                        filterByTitle: val1,
                        filterByLocation: val2,
                        filterByContract: val3 
                    }
                }

                form.addEventListener('submit', (e)=> {
                    const submittedForm = new FormData(e.target);
                    const filter1 = submittedForm.get("filter1");
                    const filter2 = submittedForm.get("filter2");
                    const filter3 = submittedForm.get("filter3");


                    // At least one field present
                    if (filter1.trim() || filter2.trim() || filter3) {
                        e.preventDefault();
                        filters = setValues(filter1, filter2, filter3);
                        console.log("value of filters:", filters)
                        container.innerHTML = "";

                        // Full time only checked
                        if (filters.filterByContract) {
                            const abC = unfiltered.filter(job => job.contract === "Full Time");

                            // Full time jobs by specific location only
                            if (filters.filterByLocation.trim() && !filters.filterByTitle.trim()) {
                                const abCL = abC.filter(job => job.location.toLowerCase().includes(filters.filterByLocation.trim().toLowerCase()));

                                for (let i = 0; i < abCL.length; i++) {                    
                                    container.innerHTML += content(abCL, i);
                                }
                            }

                            // Full time jobs by specific Job Title or Company or Expertise only
                            else if (!filters.filterByLocation.trim() && filters.filterByTitle.trim()) {
                                const abCT = abC.filter(job => job.position.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.company.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.description.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()));

                                for (let i = 0; i < abCT.length; i++) {                    
                                    container.innerHTML += content(abCT, i);
                                }
                            }

                            // All filters
                            else if (filters.filterByLocation.trim() && filters.filterByTitle.trim()) {
                                const abCL = abC.filter(job => job.location.toLowerCase().includes(filters.filterByLocation.trim().toLowerCase()));

                                const abAll = abCL.filter(job => job.position.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.company.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.description.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()));

                                for (let i = 0; i < abAll.length; i++) {                    
                                    container.innerHTML += content(abAll, i);
                                }
                            }
                            // Only full time jobs
                            else {
                                for (let i = 0; i < abC.length; i++) {                    
                                    container.innerHTML += content(abC, i);
                                }
                            }
                            
                        }

                        else if (!filters.filterByContract && filters.filterByLocation.trim()) {

                                const abCL = unfiltered.filter(job => job.location.toLowerCase().includes(filters.filterByLocation.trim().toLowerCase()));

                                if (filters.filterByTitle.trim()) {
                                    const abCT = abCL.filter(job => job.position.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.company.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.description.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()));

                                    for (let i = 0; i < abCT.length; i++) {                    
                                        container.innerHTML += content(abCT, i);
                                    }
                                }

                                else {
                                    for (let i = 0; i < abCL.length; i++) {                    
                                        container.innerHTML += content(abCL, i);
                                    }
                                }
                            }

                        else if (!filters.filterByContract && !filters.filterByLocation.trim() && filters.filterByTitle.trim()) {
                                const abCT = unfiltered.filter(job => job.position.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.company.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()) || job.description.toLowerCase().includes(filters.filterByTitle.trim().toLowerCase()));

                                for (let i = 0; i < abCT.length; i++) {                    
                                    container.innerHTML += content(abCT, i);
                                }
                            }
                        else {
                            return false;
                        }

                        loadMore.disabled = "true";

                    }
                    return;
                    
                })


                const response = unfiltered;
                const len = response.length;
                let batchNumber = 1;
                let load = 9;
                let addLoad = 9;
                let totalBatches = len % 2 === 0 ? Math.floor(len / load) : Math.floor(len / load) + 1;
                // First Batch Load of Jobs
                for (let i = 0; i < load; i++) {                    
                    container.innerHTML += content(response, i);
                }

                loadMore.addEventListener('click', await function(e) {
                    e.preventDefault();
                    if (response && len > addLoad && batchNumber < totalBatches && load < len) {
                        batchNumber++;
                        for (let j = load; j < addLoad + load; j++) {
                            container.innerHTML += content(response, j);
                        }
                        load += addLoad;
                    } else {
                        loadMore.disabled = "true";
                    }
                })

            } catch(e) {
                console.log(e);
            }
        })();
    </script>
    <script>
        const sendLocal = (data) => {
            if (data) {
                localStorage.setItem("data", JSON.stringify(data));
                window.location.href = "details.html"
            }
            else console.log('Cant');
        }

        themeToggler.addEventListener('click', (e) => {
            document.body.classList.toggle("dark-theme-variables");
            themeToggler.querySelector('span:nth-child(1)').classList.toggle('active');
            themeToggler.querySelector('span:nth-child(2)').classList.toggle('active');
            if (document.body.className === "dark-theme-variables") {
                localStorage.setItem('dark', "dark-theme-variables")
            } else {
                localStorage.setItem('dark', '')
            }
        })

        if (localStorage.getItem('dark')) {
            document.body.classList.toggle("dark-theme-variables");
            themeToggler.querySelector('span:nth-child(1)').classList.toggle('active');
            themeToggler.querySelector('span:nth-child(2)').classList.toggle('active');
        }
    </script>
</body>
</html>
